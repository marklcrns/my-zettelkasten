<!-- Credits: https://github.com/DevonMorris/zettelkasten/blob/master/head.html -->
<!--          https://github.com/alex-a-soto/zettelkasten/blob/master/head.html -->

<link rel="preconnect" href="https://fonts.gstatic.com">
<link href="https://fonts.googleapis.com/css2?family=Cormorant+Unicase:wght@700&family=Cormorant:ital,wght@0,600;1,600&family=Montserrat:ital,wght@0,400;0,700;1,400&display=swap" rel="stylesheet">
<script async="" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.23.0/themes/prism.min.css" rel="stylesheet" />
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.23.0/components/prism-core.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.23.0/plugins/autoloader/prism-autoloader.min.js"></script>

<div class="search-box">
  <div class="search">
    <input type="text" autocomplete="none" autocorrect="none" autocapitalize="none" spellcheck="false" value/>
    <button class="clear">Ã—</button>
  </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/minisearch@3.1.0/dist/umd/index.min.js"></script>
<script charset="utf-8">
  window.addEventListener("load", function(){
    $.getJSON('../cache.json', function(data) {
      var graph = buildGraph(data.Graph).nodes
      console.log(graph);

      let miniSearch = new MiniSearch({
        fields: ['title'], // fields to index for full-text search
        storeFields: ['title', 'date', 'tags'] // fields to return with search results
      })

      // Index all documents
      miniSearch.addAll(graph)
      let results = miniSearch.search('Reward Sens')
      console.log(results);
    })
  });

  function buildGraph(data) {
    var graph = {};
    var excludedNodes = ["index", "README", "faq", "LICENSE"];

    // Build nodes
    var nodes = [];
    Object.entries(data.vertices).forEach(([node,e]) => {
      if (!excludedNodes.includes(e.ID)) {
        var node = {}
        // Meta
        node.id = e.ID;
        node.title = e.Title;
        node.slug = e.Slug;
        node.date = new Date(e.Date).toDateString();
        node.tags = e.Meta.tags;
        nodes.push(node);
      }
    })

    graph.nodes = nodes;
    return graph;
  }
</script>

<style>
  body .universe {
    background-color: #fff !important;
    color: #333;
  }

  a {
    color: teal;
  }

  img[alt*="Me"],
  img.me {
    display: block;
    margin-left: auto;
    margin-right: 0%;
    margin-top: -10%;
    border-radius: 50%;
    width: 100px;
    height: 100px;
    object-fit: cover;
  }

  img[alt*="wide"],
  img.wide {
    display: block;
    margin-left: auto;
    margin-right: auto;
    width: 100%;
    height: auto;
    max-width: 800px;
  }

  img[alt*="wide-left"],
  img.wide-left {
    float: left;
    margin-left: auto;
    margin-right: auto;
    width: 100%;
    height: auto;
    max-width: 800px;
  }

  img[alt*="wide-right"],
  img.wide-right {
    float: right;
    margin-left: auto;
    margin-right: auto;
    width: 100%;
    height: auto;
    max-width: 800px;
  }

  img[alt*="tall"],
  img.tall {
    display: block;
    margin-left: auto;
    margin-right: auto;
    width: auto;
    height: 100%;
    max-height: 800px;
  }

  img[alt*="tall-left"],
  img.tall-left {
    float: left;
    margin-left: auto;
    margin-right: auto;
    width: auto;
    height: 100%;
    max-height: 800px;
  }

  img[alt*="tall-right"],
  img.tall-right {
    float: right;
    margin-left: auto;
    margin-right: auto;
    width: auto;
    height: 100%;
    max-height: 800px;
  }

  img[alt*="square"],
  img.square {
    display: block;
    margin-left: auto;
    margin-right: auto;
    width: 100%;
    height: auto;
    max-width: 400px;
    max-height: 400px;
  }

  img[alt*="square-left"],
  img.square-left {
    float: left;
    margin-left: auto;
    margin-right: auto;
    width: 100%;
    height: auto;
    max-width: 400px;
    max-height: 400px;
  }

  img[alt*="square-right"],
  img.square-right {
    float: right;
    margin-left: auto;
    margin-right: auto;
    width: 100%;
    height: auto;
    max-width: 400px;
    max-height: 400px;
  }

  img[alt*="square-small"],
  img.square-small {
    display: block;
    margin-left: auto;
    margin-right: auto;
    width: 100%;
    height: auto;
    max-width: 300px;
    max-height: 300px;
  }

  img[alt*="square-small-left"],
  img.square-small-left {
    float: left;
    margin-left: auto;
    margin-right: auto;
    width: 100%;
    height: auto;
    max-width: 300px;
    max-height: 300px;
  }

  img[alt*="square-small-right"],
  img.square-small-right {
    float: right;
    margin-left: auto;
    margin-right: auto;
    width: 100%;
    height: auto;
    max-width: 300px;
    max-height: 300px;
  }

  img[alt*="square-large"],
  img.square-large {
    display: block;
    margin-left: auto;
    margin-right: auto;
    width: 100%;
    height: auto;
    max-width: 600px;
    max-height: 600px;
  }

  img[alt*="square-large-left"],
  img.square-large-left {
    float: left;
    margin-left: auto;
    margin-right: auto;
    width: 100%;
    height: auto;
    max-width: 600px;
    max-height: 600px;
  }

  img[alt*="square-large-right"],
  img.square-large-right {
    float: right;
    margin-left: auto;
    margin-right: auto;
    width: 100%;
    height: auto;
    max-width: 600px;
    max-height: 600px;
  }

  /* Relax width constraint a bit */
  #zettel-container {
    max-width: 100% !important;
    max-height: 100% !important;
  }

  .ui.ui.ui.container:not(.fluid) {
    width: 100%
  }

  .ui.raised.raised.segment, .ui.raised.raised.segments {
    box-shadow: none;
  }

  /* .ui.attached.segment { */
  /*   border: none;        */
  /* }                      */

  .tldr {
    text-align: center;
    margin-top: 50px;
    margin-bottom: 50px;
  }

  .tldr p {
    font-style: italic;
    background-color: rgba(200, 200, 200, 0.2);
    padding: 5px;
  }

  .ui.attached.segment.zettel-content p,
  .ui.attached.segment.zettel-content ul,
  .ui.attached.segment.zettel-content pre,
  .ui.attached.segment.zettel-content iframe,
  section.tag-query-results {
    margin-left: 1.2em;
    margin-right: 1.2em;
    font-size: 1.15rem;
  }

  .ui.attached.segment.zettel-content h2,
  .ui.attached.segment.zettel-content h3,
  .ui.attached.segment.zettel-content h4,
  .ui.attached.segment.zettel-content h5 {
    margin-left: 0.5em;
    margin-right: 0.5em;
  }

  #neuron-backlinks-pane {
    padding-left: 1em;
    padding-right: 1em;
  }

  .ui.segment {
    border: none;
  }

  .ui.header + p {
    margin-top: 1.7em;
  }

  body .zettel-content h1#title-h1 {
    background-color: white !important;
    padding-top: 0.5em;
    padding-bottom: 0.5em;
    font-family: 'Montserrat', sans-serif !important;
    font-weight: 500;
    font-size: 3.5em;
    text-align: center;
    text-shadow: 2px 2px 3px #c1c1c1;
  }

  body h1 {
    background-color: white !important;
    padding-top: 0.5em;
    padding-bottom: 0.5em;
    font-family: 'Montserrat', sans-serif !important;
    font-weight: 500;
    font-size: 3em;
    text-align: center;
  }

  body div.zettel-view .zettel-content h2 {
    border-bottom: none !important;
    text-align: center;
  }

  body h2, h3, h4, h5, h6 {
    font-family: 'Montserrat', sans-serif !important;
    font-weight: 400;
    font-size: 2.2em;
  }

  body h3, h4, h5, h6 {
    font-size: 1.5em;
    margin: 1.5em 0px 0.5em 0px;
  }

  body p, li, a {
    font-family: 'Montserrat', sans-serif !important;
    font-weight: 400;
  }

  div.pandoc {
    margin-left: 2.0em;
    margin-right: 2.0em;
  }

  /* Hide the query divider */
  div.pandoc section.tag-query-results .divider {
    display: none !important;
  }

  div.pandoc section.tag-query-results .ui.list {
    padding-left: 1em;
  }

  progress[value] {
    /* Reset the default appearance */
    -webkit-appearance: none;
    -moz-appearance: none;
    appearance: none;

    border: none;

    width: 50%;
    height: 20px;
    background-color: #ececec;
    border-radius: 10px;
  }
  progress[value]::-webkit-progress-bar {
    background-color: #ececec;
    width: 50%;
    border-radius: 10px;
  }
  progress[value]::-webkit-progress-value {
    background-color: #19a6a6;
    width: 50%;
    border-radius: 10px;
  }
  progress[value]::-moz-progress-bar {
    background-color: #19a6a6;
    border-radius: 10px;
  }
  .center {
    margin-left: auto;
    margin-right: auto;
    display: block;
  }
</style>

<!-- Modify html onload -->
<script charset="utf-8">
  window.onload = function() {
    // Add social share buttons if zettel not WIP
    var isWIP = false;
    var isDraft = false;
    var tagsPane = document.getElementById('neuron-tags-pane');
    if (tagsPane) {
      for (const [index, e] of document.getElementById('neuron-tags-pane').firstChild.childNodes.entries()) {
        if (e.innerHTML === "wip" || e.innerHTML === "draft") {
          isWIP = true;
          isDraft = e.innerHTML === "draft";
          var h1 = document.createElement("h1");
          var title = document.getElementById("title-h1");

          // Add another title to zettels with wip or draft tag metadata
          if (isDraft) {
            h1.innerHTML = "ðŸ” IN REVIEW";
          } else {
            h1.innerHTML = "ðŸš§ WORK IN PROGRESS";
          }

          title.parentNode.insertBefore(h1, title);
          break;
        }
      }
      if (!isWIP) {
        var contentDiv = document.getElementsByClassName("zettel-content")[0];
        var sectionDiv = document.createElement("div");
        sectionDiv.classList = "ui section divider";
        var sectionSocial = document.createElement("div");
        sectionSocial.id = "socialMediaLinks";
        // Facebook btn
        var facebookBtn = document.createElement("a");
        var facebookIcon = document.createElement("i");
        facebookBtn.id = "facebook";
        facebookBtn.title = "Share on Facebook";
        facebookBtn.classList = "ui facebook button";
        facebookIcon.classList = "facebook icon";
        facebookBtn.addEventListener("click", function(e) {
          window.open('https://www.facebook.com/sharer/sharer.php?u=' + encodeURIComponent(document.URL) + '&quote=' + encodeURIComponent(document.URL)); return false;
        });
        facebookBtn.appendChild(facebookIcon);
        facebookBtn.innerHTML += "Share";
        // Tweeter btn
        var twitterBtn = document.createElement("a");
        var twitterIcon = document.createElement("i");
        twitterBtn.id = "twitter";
        twitterBtn.title = "Tweet";
        twitterBtn.classList = "ui twitter button";
        twitterIcon.classList = "twitter icon";
        twitterBtn.addEventListener("click", function(e) {
          window.open('https://twitter.com/intent/tweet?text=' + encodeURIComponent(document.title) + ':%20' + encodeURIComponent(document.URL)); return false;
        });
        twitterBtn.appendChild(twitterIcon);
        twitterBtn.innerHTML += "Tweet";
        // LinkedIn btn
        var linkedinBtn = document.createElement("a");
        var linkedinIcon = document.createElement("i");
        linkedinBtn.id = "linkedin";
        linkedinBtn.title = "Share on LinkedIn";
        linkedinBtn.classList = "ui linkedin button";
        linkedinIcon.classList = "linkedin icon";
        linkedinBtn.addEventListener("click", function(e) {
          window.open('https://www.linkedin.com/shareArticle?mini=true&url=' + encodeURIComponent(document.URL) + '&title=' +  encodeURIComponent(document.title)); return false;
        });
        linkedinBtn.appendChild(linkedinIcon);
        linkedinBtn.innerHTML += "Share";
        // Reddit btn
        var redditBtn = document.createElement("a");
        var redditIcon = document.createElement("i");
        redditBtn.id = "reddit";
        redditBtn.title = "Share on Reddit";
        redditBtn.classList = "ui reddit button";
        redditIcon.classList = "reddit icon";
        redditBtn.addEventListener("click", function(e) {
          window.open('https://www.reddit.com/submit?url=' + encodeURIComponent(document.URL) + '&title=' +  encodeURIComponent(document.title)); return false;
        });
        redditBtn.appendChild(redditIcon);
        redditBtn.innerHTML += "Share";

        var hackernewsBtn = document.createElement("a");
        var hackernewsIcon = document.createElement("i");
        hackernewsBtn.id = "hackernews";
        hackernewsBtn.title = "Share on Hacker News";
        hackernewsBtn.classList = "ui hacker news button";
        hackernewsIcon.classList = "hacker news icon";
        hackernewsBtn.addEventListener("click", function(e) {
          window.open('https://news.ycombinator.com/submitlink?u=' + encodeURIComponent(document.URL) + '&t=' + encodeURIComponent(document.title)); return false;
        });
        hackernewsBtn.appendChild(hackernewsIcon);
        hackernewsBtn.innerHTML += "Share";

        sectionSocial.appendChild(facebookBtn);
        sectionSocial.appendChild(twitterBtn);
        sectionSocial.appendChild(linkedinBtn);
        sectionSocial.appendChild(redditBtn);
        sectionSocial.appendChild(hackernewsBtn);
        contentDiv.appendChild(sectionDiv);
        contentDiv.appendChild(sectionSocial);
      }
    }

    // replace logo with copyright
    let element = document.querySelector('div.footer-version > div > a > img[alt="logo"]')
    let parent = element.parentNode.parentNode.parentNode
    // element.remove()

    let p = document.createElement("p")
    let n = document.createTextNode("Â© 2021 Mark Lucernas")
    p.appendChild(n)
    p.style.height = "100%";
    p.style.paddingBottom = "10px";
    // parent.appendChild(n)
    parent.replaceChild(p, parent.firstChild)
    // parent.replaceChild(element.parentNode, p)
  }
</script>

<!-- Add event listener to RSS btn -->
<script charset="utf-8">
  window.addEventListener("load", function(){
    var socialButtons = document.getElementById("subscriptionLinks");
    if (socialButtons) {
      socialButtons.innerHTML += "<a id='rss' title='Subscribe to RSS feed' class='ui rss button'><i class='rss square icon'></i> RSS</a>"
      document.getElementById("rss").addEventListener("click", function(e) {
        window.open('https://marklucernas.dev/index.xml');
      });
    }
  })
</script>

<style>
#socialMediaLinks {
  text-align: center;
}

#socialMediaLinks .ui.reddit.button {
  background: #FF5700;
  color: #ffffff;
}

#socialMediaLinks .ui.hacker.news.button {
  background: #ff4000;
  color: #ffffff;
}

#socialMediaLinks .ui.rss.button {
  background: #FF9249;
  color: #ffffff;
}

#subscriptionLinks .ui.rss.button {
  background: #FF9249;
  color: #ffffff;
}

#subscriptionLinks {
  text-align: center;
}
</style>

<!-- mermaidjs -->
<script src="https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js"></script>
<script>window.addEventListener("load", mermaid.initialize({startOnLoad:true}))</script>

<!-- graphviz -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/viz.js/2.1.2/viz.js" integrity="sha512-vnRdmX8ZxbU+IhA2gLhZqXkX1neJISG10xy0iP0WauuClu3AIMknxyDjYHEpEhi8fTZPyOCWgqUCnEafDB/jVQ==" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/viz.js/2.1.2/full.render.js" integrity="sha512-1zKK2bG3QY2JaUPpfHZDUMe3dwBwFdCDwXQ01GrKSd+/l0hqPbF+aak66zYPUZtn+o2JYi1mjXAqy5mW04v3iA==" crossorigin="anonymous"></script>
<script>
  window.addEventListener("load", function(){
      let viz = new Viz();
      for (let element of document.getElementsByClassName("graphviz")) {
          let parent = element.parentNode
          let pparent = parent.parentNode
          viz.renderSVGElement(element.textContent)
            .then(function(element) {
                element.setAttribute("width", "100%")
                pparent.replaceChild(element, parent)
              });
        }
    });
</script>

<!-- chartjs -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.9.4/Chart.bundle.min.js" integrity="sha512-SuxO9djzjML6b9w9/I07IWnLnQhgyYVSpHZx0JV97kGBfTIsUYlWflyuW4ypnvhBrslz1yJ3R+S14fdCWmSmSA==" crossorigin="anonymous"></script>
<script charset="utf-8">
  window.addEventListener("load", function(){
      for (let element of document.getElementsByClassName("chartjs")) {
          let parent = element.parentNode
          let pparent = parent.parentNode
          let canvas = document.createElement('canvas');
          let box = document.createElement('div');
          box.appendChild(canvas);
          let ctx = canvas.getContext("2d")
          let myChart = new Chart(ctx, JSON.parse(element.textContent));
          box.setAttribute("style","display:block;width:75%;text-align:'center';margin: 5px auto;");
          pparent.replaceChild(box, parent)
        }
    });
</script>

<script async defer src="https://scripts.simpleanalyticscdn.com/latest.js"></script>
<noscript><img src="https://queue.simpleanalyticscdn.com/noscript.gif" alt=""/></noscript>
